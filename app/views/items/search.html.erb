<p id="notice"><%= notice %></p>

<h1>Search</h1> 

<% query = "" %>
<% if params.has_key?(:query) %>
    <% query = params[:query] %>
<% end %>

<input type="text" name="search" id="search", value=<%= query %>>
<button onclick='window.searchHandler()'>Search!</button>

<table>
  <thead>
    <tr>
        <th>Description</th>
        <th>Price</th>
        <th>Condition</th>
        <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% if @items.count > 0%>
        <% @items.each do |item| %>
            <% if (item.description.downcase.include?(query.downcase) ) %>
                <tr>
                    <td><%= item.description %></td>
                    <td><%= item.price %></td>
                    <td><%= item.condition %></td>
                    <td><%= link_to 'Show', item %></td>

                    <% if user_signed_in?  && current_user.items.include?(item) %>
                        <td><%= link_to 'Edit', edit_item_path(item) %></td>
                        <td><%= link_to 'Destroy', item, method: :delete, data: { confirm: 'Are you sure?' } %></td>
                    <% end %>
                </tr>
            <% end %>
        <% end %>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Item', new_item_path %>
