<div class="container-fluid">
    <% query = "" %>
    <% if params.has_key?(:query) %>
        <% query = params[:query] %>
    <% end %>

    <div class="container-fluid col-8 p-2" style="max-width:600px">
        <div class="input-group input-group-lg bg-white rounded border">
            <input type="text" name="search" id="search" class="form-control border-0 text"  value=<%= query %>>
            <button id="searchButton" onclick='window.searchHandler()' class="btn btn-outline-secondary bg-dark text-white">Search!</button>
            <script>
                document.getElementById("search").addEventListener("keyup", function(e) {
                    if (e.keyCode === 13) {
                        document.getElementById("searchButton").click();
                    }
                })
            </script>
        </div>
    </div>
    <div class="container-fluid col-8 p-2" style="max-width:600px">
        <div class="input-group input-group-lg bg-white rounded border">
            <select class="form-select" aria-label="Default select example">
                <option value="0" selected>Any</option>
                <option value="1">CPU</option>
                <option value="2">GPU</option>
                <option value="3">RAM</option>
                <option value="4">Motherboard</option>
                <option value="5">Power Supply</option>
                <option value="6">HDD</option>
                <option value="7">SDD</option>
            </select>
        </div>
    </div>
    
    <% sort_param = 0 %>
    <div class="container-fluid col-8 p-2" style="max-width:600px">
        <div class="input-group input-group-lg bg-white rounded border">
            <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active btn btn-dark" id="pills-home-tab" data-bs-toggle="pill" data-bs-target="#pills-home" type="button" role="tab" aria-controls="pills-home" aria-selected="true">Date Listed</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link btn btn-dark" id="pills-profile-tab" data-bs-toggle="pill" data-bs-target="#pills-profile" type="button" role="tab" aria-controls="pills-profile" aria-selected="false">Price</button>
                </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                <div class="tab-pane fade show active" id="pills-home" role="tabpanel" aria-labelledby="pills-home-tab">
                    <select class="form-select" aria-label="Default select example">
                        <option selected>Newest to Oldest</option>
                        <option value="2">Oldest to Newest</option>
                    </select>
                </div>
                <div class="tab-pane fade" id="pills-profile" role="tabpanel" aria-labelledby="pills-profile-tab">
                    <select class="form-select" aria-label="Default select example">
                        <option selected>Lowest to Highest</option>
                        <option value="2">Highest to Lowest</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <br>

    <div class="row row-cols-1 row-cols-md-1 g-4 justify-content-center">
        <% if @items.count > 0 %>
            <% @items.each do |item| %>
                <% if (item.description.downcase.include?(query.downcase) ) %>
                    
                    <div class="card mb-3 m-2" style="max-width: 540px;">
                        <div class="row g-0">
                            <% unless item.images[0].nil?  %>
                                <div class="col-md-6">
                                    <% item.images.each do |photo| %>
                                        <%= image_tag(photo, :width => 200) %>
                                    <% end %>
                                    </div>  
                                    <div class="col-md-6"> 
                                <% else %>

                                    <div class="col-md-12"> 

                                <% end%>
                                <div class="card-body">
                                    <h5 class="card-title"><%= item.description %></h5>
                                    <p class="card-text"><%= number_to_currency item.price %></p>
                                    <p class="card-text"><%= item.condition %></p>
                                    <p class="card-text"><%= item.status ? "Available" : "Sold" %></p>
                                    <p class="card-text"><small class="text-muted">Posted <%= time_ago_in_words(item.created_at) %> ago.</small></p>
                                </div>
                            </div>
                            <a href="<%= item_path(item.id) %>" class="stretched-link"></a>
                        </div>
                    </div>
                <% end %>
            <% end %>
        <% end %>
        <br>
    </div>
</div>